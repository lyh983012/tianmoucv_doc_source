<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TianMouCV算法库 &mdash; Tianmouc alpha 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=406e4f49"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/translations.js?v=beaddf03"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Haris角点和SIFT特征描述符" href="feature_matching/feature_matching.html" />
    <link rel="prev" title="欢迎来到天眸视觉(TianMouCV)的项目主页" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Tianmouc
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">Outline</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">TianMouCV算法库</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#readme">README</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unix">Unix系统安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="#windows">Windows系统安装</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id1">数据解码说明</a></li>
<li class="toctree-l2"><a class="reference internal" href="#index-basic">说明文档索引</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tianmocu-data-reader">Tianmocu原始数据读取(data reader)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#usb-data">USB data 读取</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pice-data">PICE data 读取</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#isp">ISP处理方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tianmocu-python-usb">Tianmocu python相机接口(仅支持usb)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#proc">算法库(proc)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-tianmoucv.proc.features.diff">特征库(features)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tianmoucv.proc.features.diff.sobel_operator"><code class="docutils literal notranslate"><span class="pre">sobel_operator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianmoucv.proc.features.diff.gaussain_kernel"><code class="docutils literal notranslate"><span class="pre">gaussain_kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianmoucv.proc.features.diff.gaussian_smooth"><code class="docutils literal notranslate"><span class="pre">gaussian_smooth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianmoucv.proc.features.diff.HarrisCorner"><code class="docutils literal notranslate"><span class="pre">HarrisCorner()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianmoucv.proc.features.diff.TomasiCorner"><code class="docutils literal notranslate"><span class="pre">TomasiCorner()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianmoucv.proc.features.diff.HarrisCorner3"><code class="docutils literal notranslate"><span class="pre">HarrisCorner3()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianmoucv.proc.features.diff.hog"><code class="docutils literal notranslate"><span class="pre">hog()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tianmoucv.proc.features.diff.sift"><code class="docutils literal notranslate"><span class="pre">sift()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#index-tracking">特征库追踪</a></li>
<li class="toctree-l3"><a class="reference internal" href="#opticalflow">光流算法库(opticalFlow)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reconstructor">重建算法库(reconstructor)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#index-examples">调用示例</a><ul>
<li class="toctree-l3"><a class="reference internal" href="feature_matching/feature_matching.html">Haris角点和SIFT特征描述符</a></li>
<li class="toctree-l3"><a class="reference internal" href="feature_tracking_tested/feature_tracking_tested.html">基于SD的特征追踪</a></li>
<li class="toctree-l3"><a class="reference internal" href="opticalflow_HS_method/opticalflow_HS_method.html">基于HS方法的实时光流计算</a></li>
<li class="toctree-l3"><a class="reference internal" href="opticalflow_LK_method/opticalflow_LK_method.html">基于LK方法的实时光流计算</a></li>
<li class="toctree-l3"><a class="reference internal" href="opticalflow_SPYNET/opticalflow_SPYNET.html">基于SpyNet的光流网络</a></li>
<li class="toctree-l3"><a class="reference internal" href="reconstruct_gray/reconstruct_gray.html">基于AOP的灰度重建</a></li>
<li class="toctree-l3"><a class="reference internal" href="reconstruct_hdr_Laplacian/reconstruct_hdr_Laplacian.html">HDR单帧合成</a></li>
<li class="toctree-l3"><a class="reference internal" href="reconstruct_tiny_unet/reconstruct_tiny_unet.html">轻量化视频重建</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Tianmouc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">TianMouCV算法库</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tianmoucv/introduction.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tianmoucv">
<h1>TianMouCV算法库<a class="headerlink" href="#tianmoucv" title="Link to this heading"></a></h1>
<p>这里是代码库的简要介绍和概述。</p>
<p>目前doc基于Tianmoucv-0.3.2版本，已开源
开发版本为0.3.5.4，待开源</p>
<section id="readme">
<h2>README<a class="headerlink" href="#readme" title="Link to this heading"></a></h2>
<p><strong>如果你用的是preview版本，下面的tianmouc都替换成Tianmoucv_preview</strong></p>
<section id="unix">
<h3>Unix系统安装<a class="headerlink" href="#unix" title="Link to this heading"></a></h3>
<p>step 1. 安装基本的编译工具</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>make
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>cmake
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>build-essential
</pre></div>
</div>
<p>注:macOS使用brew安装gcc/g++，install默认使用g++</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>brew<span class="w"> </span>install<span class="w"> </span>make
brew<span class="w"> </span>install<span class="w"> </span>cmake
brea<span class="w"> </span>install<span class="w"> </span>g++,gcc
</pre></div>
</div>
<p>step 2. 安装python和pytorch，尽量使用cuda版本与anaconda</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>tianmoucv<span class="w"> </span>--python<span class="o">=</span><span class="m">3</span>.10
conda<span class="w"> </span>activate<span class="w"> </span>tianmoucv
conda<span class="w"> </span>install<span class="w"> </span>pytorch<span class="w"> </span>torchvision<span class="w"> </span>torchaudio<span class="w"> </span>pytorch-cuda<span class="o">=</span><span class="m">12</span>.0<span class="w"> </span>-c<span class="w"> </span>pytorch<span class="w"> </span>-c<span class="w"> </span>nvidia
</pre></div>
</div>
<p>step 3. 执行自动安装脚本</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>tianmoucv<span class="w"> </span>-i<span class="w"> </span>https://pypi.tuna.tsinghua.edu.cn/simple
</pre></div>
</div>
<p>或者从源码安装(某些特殊情况下.so文件无法自动编译时可使用)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/Tianmouc/tianmoucv_preview.git
<span class="nb">cd</span><span class="w"> </span>tianmoucv_preview
sh<span class="w"> </span>install.sh
</pre></div>
</div>
</section>
<section id="windows">
<h3>Windows系统安装<a class="headerlink" href="#windows" title="Link to this heading"></a></h3>
<p>step 1. 安装基本的编译工具</p>
<p>安装minGW,make,cmake，git 前往对应官网下载</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.mingw-w64.org/">https://www.mingw-w64.org/</a></p></li>
</ul>
<p>minGW是一个windows上的gnu最小系统，建议直接下载最新版本的预编译压缩包,以支持最新的c++协议</p>
<p><a class="reference external" href="https://github.com/niXman/mingw-builds-binaries/releases">https://github.com/niXman/mingw-builds-binaries/releases</a></p>
<p>将解压后的文件中的bin文件夹路径添加到系统环境变量中的PATH内，保证命令行可以直接调用g++</p>
<p>（optional）如果你需要使用sdk，那么你还需要进一步安装opencv和cyusb，然后安装cmake</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cmake.org/download/">https://cmake.org/download/</a></p></li>
<li><p><a class="reference external" href="https://gnuwin32.sourceforge.net/packages/make.htm">https://gnuwin32.sourceforge.net/packages/make.htm</a></p></li>
<li><p><a class="reference external" href="https://git-scm.com/download/win">https://git-scm.com/download/win</a></p></li>
</ul>
<p>step 2. 安装python和pytorch，尽量使用cuda版本与anaconda</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>tianmoucv<span class="w"> </span>--python<span class="o">=</span><span class="m">3</span>.10
conda<span class="w"> </span>activate<span class="w"> </span>tianmoucv
conda<span class="w"> </span>install<span class="w"> </span>pytorch<span class="w"> </span>torchvision<span class="w"> </span>torchaudio<span class="w"> </span>pytorch-cuda<span class="o">=</span><span class="m">12</span>.0<span class="w"> </span>-c<span class="w"> </span>pytorch<span class="w"> </span>-c<span class="w"> </span>nvidia
</pre></div>
</div>
<p>step 3. 执行自动安装脚本</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:Tianmouc/tianmoucv.git
<span class="nb">cd</span><span class="w"> </span>tianmoucv
./install.bat
</pre></div>
</div>
</section>
</section>
<section id="id1">
<h2>数据解码说明<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/decode.jpg"><img alt="../_images/decode.jpg" src="../_images/decode.jpg" style="width: 80%;" /></a>
<p>解码数据在tianmoucv.data的self.prepocess输入之前完成</p>
</section>
<section id="index-basic">
<span id="id2"></span><h2>说明文档索引<a class="headerlink" href="#index-basic" title="Link to this heading"></a></h2>
<ul>
<li><p><a class="reference internal" href="#index-data"><span class="std std-ref">数据</span></a></p></li>
<li><p><a class="reference internal" href="#index-isp"><span class="std std-ref">ISP处理方法</span></a></p></li>
<li><p><a class="reference internal" href="#index-camera"><span class="std std-ref">usb sdk接口</span></a></p></li>
<li><p><a class="reference internal" href="#index-proc"><span class="std std-ref">算法库</span></a></p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#index-features"><span class="std std-ref">特征</span></a></p></li>
<li><p><a class="reference internal" href="#index-tracking"><span class="std std-ref">追踪</span></a></p></li>
<li><p><a class="reference internal" href="#index-of"><span class="std std-ref">光流</span></a></p></li>
<li><p><a class="reference internal" href="#index-rec"><span class="std std-ref">重建</span></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p><a class="reference internal" href="#index-examples"><span class="std std-ref">调用示例</span></a></p></li>
</ul>
</section>
<section id="tianmocu-data-reader">
<span id="index-data"></span><h2>Tianmocu原始数据读取(data reader)<a class="headerlink" href="#tianmocu-data-reader" title="Link to this heading"></a></h2>
<section id="usb-data">
<h3>USB data 读取<a class="headerlink" href="#usb-data" title="Link to this heading"></a></h3>
</section>
<section id="pice-data">
<h3>PICE data 读取<a class="headerlink" href="#pice-data" title="Link to this heading"></a></h3>
</section>
</section>
<section id="isp">
<span id="index-isp"></span><h2>ISP处理方法<a class="headerlink" href="#isp" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.isp_basic.</span></span><span class="sig-name descname"><span class="pre">default_rgb_isp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/isp_basic.html#default_rgb_isp"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>默认的RGB RAW数据处理流程</p>
<ul class="simple">
<li><p>空洞填补</p></li>
<li><p>去马赛克</p></li>
<li><p>白平衡</p></li>
<li><p>自适应降噪</p></li>
<li><p>自动饱和度</p></li>
<li><p>自动曲线</p></li>
<li><p>自动归一化</p></li>
</ul>
<p>注意: 速度非常慢，仅供参考</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.isp_basic.</span></span><span class="sig-name descname"><span class="pre">ACESToneMapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapted_lum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/isp_basic.html#ACESToneMapping"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p><a class="reference external" href="https://zhuanlan.zhihu.com/p/21983679">https://zhuanlan.zhihu.com/p/21983679</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.isp_basic.</span></span><span class="sig-name descname"><span class="pre">Scurve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curve_factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/isp_basic.html#Scurve"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>曲线调整
:param img: cv2.imread读取的图片数据
:curve_factor: 增加对比度，值越大对比度越大
:return: 返回的白平衡结果图片数据</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.isp_basic.</span></span><span class="sig-name descname"><span class="pre">adjust_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curve_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/isp_basic.html#adjust_curve"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>曲线调整</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.isp_basic.</span></span><span class="sig-name descname"><span class="pre">adjust_saturation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saturation_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(128,</span> <span class="pre">256)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/isp_basic.html#adjust_saturation"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>饱和度调整</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> – cv2.imread读取的图片数据</p>
</dd>
<dt class="field-even">Saturation_factor<span class="colon">:</span></dt>
<dd class="field-even"><p>增加饱和度，saturation_factor越大饱和度越大</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>返回的饱和度结果图片数据</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.isp_basic.</span></span><span class="sig-name descname"><span class="pre">lyncam_raw_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/isp_basic.html#lyncam_raw_comp"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>Tianmouc Bayer 填充</p>
<p>Author: Taoyi Wang</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.isp_basic.</span></span><span class="sig-name descname"><span class="pre">exp_bayer_to_rgb_conv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bayer_image</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/isp_basic.html#exp_bayer_to_rgb_conv"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p># Define convolution kernels for each color channel
# These kernels are designed to average the surrounding pixels
# Kernel for Red and Blue channels (they are at the corners of the Bayer pattern)
lyh testing</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.isp_basic.</span></span><span class="sig-name descname"><span class="pre">demosaicing_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bayer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bayer_pattern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bggr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bitdepth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/isp_basic.html#demosaicing_npy"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>Call this function to load raw bayer image
:param bayer: input bayer image
:param level: demosaicing level. 0: bilinear linear; 1: gradient
:param bayer_type: bayer_type: : 0–RGrRGr…GbBGbB, 1–GrRGrR…BGbBGb…
Author: Taoyi Wang</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.transform.</span></span><span class="sig-name descname"><span class="pre">SD2XY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sd_raw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tensor</span></span></span><a class="reference internal" href="../_modules/tianmoucv/isp/transform.html#SD2XY"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>input: [h,w,2]/[2,h,w]/[n,2,h,w]
output: [h,2*w],[h,2*w] or [n,h,2*w],[n,h,2*w]
坐标变换规则参照http://www.tianmouc.cn:40000/tianmoucv/introduction.html</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.transform.</span></span><span class="sig-name descname"><span class="pre">compute_minimum_convex_hull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/transform.html#compute_minimum_convex_hull"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>计算最小凸包</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.transform.</span></span><span class="sig-name descname"><span class="pre">calculate_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/transform.html#calculate_area"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p># 计算多边形的面积</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.transform.</span></span><span class="sig-name descname"><span class="pre">is_inside</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/transform.html#is_inside"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p># 判断点是否在多边形内部</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.isp.transform.</span></span><span class="sig-name descname"><span class="pre">interpolate_zero_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_point</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/isp/transform.html#interpolate_zero_point"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p># 找到零点周围的非零点，进行插值</p>
</dd></dl>

</section>
<section id="tianmocu-python-usb">
<span id="index-camera"></span><h2>Tianmocu python相机接口(仅支持usb)<a class="headerlink" href="#tianmocu-python-usb" title="Link to this heading"></a></h2>
</section>
<section id="proc">
<span id="index-proc"></span><h2>算法库(proc)<a class="headerlink" href="#proc" title="Link to this heading"></a></h2>
<section id="module-tianmoucv.proc.features.diff">
<span id="features"></span><span id="index-features"></span><h3>特征库(features)<a class="headerlink" href="#module-tianmoucv.proc.features.diff" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="tianmoucv.proc.features.diff.sobel_operator">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.features.diff.</span></span><span class="sig-name descname"><span class="pre">sobel_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Iy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/features/diff.html#sobel_operator"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#tianmoucv.proc.features.diff.sobel_operator" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tianmoucv.proc.features.diff.gaussain_kernel">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.features.diff.</span></span><span class="sig-name descname"><span class="pre">gaussain_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/features/diff.html#gaussain_kernel"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#tianmoucv.proc.features.diff.gaussain_kernel" title="Link to this definition"></a></dt>
<dd><p>generate Gaussain blur kernel</p>
<dl class="simple">
<dt>parameter:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param size<span class="colon">:</span></dt>
<dd class="field-odd"><p>特征的数量，int</p>
</dd>
<dt class="field-even">param sigma<span class="colon">:</span></dt>
<dd class="field-even"><p>高斯标准差，int</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tianmoucv.proc.features.diff.gaussian_smooth">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.features.diff.</span></span><span class="sig-name descname"><span class="pre">gaussian_smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputTensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianmoucv/proc/features/diff.html#gaussian_smooth"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#tianmoucv.proc.features.diff.gaussian_smooth" title="Link to this definition"></a></dt>
<dd><p>用现有高斯核做高斯模糊</p>
<dl class="simple">
<dt>parameter:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param inputTensor<span class="colon">:</span></dt>
<dd class="field-odd"><p>待处理矩阵,torch.Tensor</p>
</dd>
<dt class="field-even">param kernel<span class="colon">:</span></dt>
<dd class="field-even"><p>高斯模糊核,torch.Tensor</p>
</dd>
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>处理后同尺寸模糊图,torch.Tensor</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tianmoucv.proc.features.diff.HarrisCorner">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.features.diff.</span></span><span class="sig-name descname"><span class="pre">HarrisCorner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Iy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmsSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/features/diff.html#HarrisCorner"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#tianmoucv.proc.features.diff.HarrisCorner" title="Link to this definition"></a></dt>
<dd><p>Harris 角点检测</p>
<div class="math notranslate nohighlight">
\[R=det(H)−ktrace(H)\]</div>
<div class="math notranslate nohighlight">
\[\lambda1 + \lambda2 = \sum I_x^2 * \sum I_y^2 - \sum I_{xy} ^ 2\]</div>
<div class="math notranslate nohighlight">
\[\lambda1 * \lambda2 = \sum I_{xy} ^ 2\]</div>
<div class="math notranslate nohighlight">
\[R = det H - k trace H ^2= \lambda_1*\lambda_2 - k(\lambda_1 + \lambda_2)^ 2\]</div>
<div class="math notranslate nohighlight">
\[= (\sum I_{X^2} * \sum I_{y^2} - \sum I_{xy} ^ 2) - k (\sum I_x^2 + \sum I_y^2)^2\]</div>
<dl class="simple">
<dt>parameter:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param Ix<span class="colon">:</span></dt>
<dd class="field-odd"><p>x方向梯度,[h,w],torch.Tensor</p>
</dd>
<dt class="field-even">param Iy<span class="colon">:</span></dt>
<dd class="field-even"><p>y方向梯度,[h,w],torch.Tensor</p>
</dd>
<dt class="field-odd">param size<span class="colon">:</span></dt>
<dd class="field-odd"><p>高斯核尺寸,int</p>
</dd>
<dt class="field-even">param th<span class="colon">:</span></dt>
<dd class="field-even"><p>控制阈值,范围是0-1,对梯度来说应该设小一点,float</p>
</dd>
<dt class="field-odd">param nmsSize<span class="colon">:</span></dt>
<dd class="field-odd"><p>最大值筛选的范围</p>
</dd>
<dt class="field-even">param k<span class="colon">:</span></dt>
<dd class="field-even"><p>是一个经验参数,0-1,float</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tianmoucv.proc.features.diff.TomasiCorner">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.features.diff.</span></span><span class="sig-name descname"><span class="pre">TomasiCorner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Iy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmsSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/features/diff.html#TomasiCorner"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#tianmoucv.proc.features.diff.TomasiCorner" title="Link to this definition"></a></dt>
<dd><p>Shi-Tomasi 角点检测
在Harris角点检测的基础上，Shi和Tomasi 在1993的一篇论文《Good Features to track》中提出了基于Harris角点检测的Shi-Tomasi方法。
经验参数需求更少，更快，但效果变差</p>
<dl class="simple">
<dt>parameter:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param Ix<span class="colon">:</span></dt>
<dd class="field-odd"><p>x方向梯度,[h,w],torch.Tensor</p>
</dd>
<dt class="field-even">param Iy<span class="colon">:</span></dt>
<dd class="field-even"><p>y方向梯度,[h,w],torch.Tensor</p>
</dd>
<dt class="field-odd">param size<span class="colon">:</span></dt>
<dd class="field-odd"><p>高斯核尺寸,int</p>
</dd>
<dt class="field-even">param index<span class="colon">:</span></dt>
<dd class="field-even"><p>前N个点,int</p>
</dd>
<dt class="field-odd">param nmsSize<span class="colon">:</span></dt>
<dd class="field-odd"><p>最大值筛选的范围</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tianmoucv.proc.features.diff.HarrisCorner3">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.features.diff.</span></span><span class="sig-name descname"><span class="pre">HarrisCorner3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Iy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">It</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/features/diff.html#HarrisCorner3"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#tianmoucv.proc.features.diff.HarrisCorner3" title="Link to this definition"></a></dt>
<dd><p>Harris3D角点，用Ix和Iy做计算，可以用SD的两个方向</p>
<p>如果小正方体沿z方向移动，那小正方体里的点云数量应该不变
如果小正方体位于边缘上，则沿边缘移动，点云数量几乎不变，沿垂直边缘方向移动，点云数量改
如果小正方体位于角点上，则有两个方向都会大幅改变点云数量
拓展到3D中则使用法向量(包含法线和方向两个信息)</p>
<div class="math notranslate nohighlight">
\[A = Ix * Ix\]</div>
<div class="math notranslate nohighlight">
\[B = Iy * Iy\]</div>
<div class="math notranslate nohighlight">
\[C = It * It\]</div>
<div class="math notranslate nohighlight">
\[D = Ix * Iy\]</div>
<div class="math notranslate nohighlight">
\[E = Ix * It\]</div>
<div class="math notranslate nohighlight">
\[F = Iy * It\]</div>
<div class="math notranslate nohighlight">
\[M= [[A F E];[F B D];[E D C]]\]</div>
<p>Harris 角点检测
similar,</p>
<div class="math notranslate nohighlight">
\[R=det(M)−ktrace(M)^2\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tianmoucv.proc.features.diff.hog">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.features.diff.</span></span><span class="sig-name descname"><span class="pre">hog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Iy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kplist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/features/diff.html#hog"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#tianmoucv.proc.features.diff.hog" title="Link to this definition"></a></dt>
<dd><p>hog 特征描述</p>
<dl class="simple">
<dt>parameter:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param Ix<span class="colon">:</span></dt>
<dd class="field-odd"><p>x方向梯度,[h,w],torch.Tensor</p>
</dd>
<dt class="field-even">param Iy<span class="colon">:</span></dt>
<dd class="field-even"><p>y方向梯度,[h,w],torch.Tensor</p>
</dd>
<dt class="field-odd">param kplist<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of [x,y] 需要hog的坐标list, list</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tianmoucv.proc.features.diff.sift">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.features.diff.</span></span><span class="sig-name descname"><span class="pre">sift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Iy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keypoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/features/diff.html#sift"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#tianmoucv.proc.features.diff.sift" title="Link to this definition"></a></dt>
<dd><p><strong>简化版SIFT中的描述子，缺少多尺度</strong></p>
<dl class="simple">
<dt>parameter:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param Ix<span class="colon">:</span></dt>
<dd class="field-odd"><p>x方向梯度,[h,w],torch.Tensor</p>
</dd>
<dt class="field-even">param Iy<span class="colon">:</span></dt>
<dd class="field-even"><p>y方向梯度,[h,w],torch.Tensor</p>
</dd>
<dt class="field-odd">param keypoints<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of [x,y] 需要sift的坐标list, list</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="index-tracking">
<span id="id3"></span><h3>特征库追踪<a class="headerlink" href="#index-tracking" title="Link to this heading"></a></h3>
</section>
<section id="opticalflow">
<span id="index-of"></span><h3>光流算法库(opticalFlow)<a class="headerlink" href="#opticalflow" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.opticalflow.estimator.</span></span><span class="sig-name descname"><span class="pre">local_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Diff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianmoucv/proc/opticalflow/estimator.html#local_norm"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>梯度归一化</p>
<dl class="simple">
<dt>parameter:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param SD<span class="colon">:</span></dt>
<dd class="field-odd"><p>待归一化项</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.opticalflow.estimator.</span></span><span class="sig-name descname"><span class="pre">LK_optical_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SD</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TD</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifInterploted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianmoucv/proc/opticalflow/estimator.html#LK_optical_flow"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>LK方法计算稠密光流</p>
<div class="math notranslate nohighlight">
\[[dx,dy]*[dI/dx,dI/dy]^T + dI/dt = 0\]</div>
<dl class="simple">
<dt>parameter:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param SD<span class="colon">:</span></dt>
<dd class="field-odd"><p>原始SD，SD[0,1]: x,y方向上的梯度,[2,h,w],torch.Tensor</p>
</dd>
<dt class="field-even">param TD<span class="colon">:</span></dt>
<dd class="field-even"><p>原始SD，TD[0]: t方向上的梯度,[1,h,w],torch.Tensor</p>
</dd>
<dt class="field-odd">param win=5<span class="colon">:</span></dt>
<dd class="field-odd"><p>取邻域做最小二乘,邻域大小</p>
</dd>
<dt class="field-even">param stride=0<span class="colon">:</span></dt>
<dd class="field-even"><p>取邻域做最小二乘,计算步长</p>
</dd>
<dt class="field-odd">param mask=None<span class="colon">:</span></dt>
<dd class="field-odd"><p>特征点tensor,binary Tensor,[h,w]</p>
</dd>
<dt class="field-even">param ifInterploted = False<span class="colon">:</span></dt>
<dd class="field-even"><p>计算结果是否与COP等大</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.opticalflow.estimator.</span></span><span class="sig-name descname"><span class="pre">HS_optical_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SD</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TD</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifInterploted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labmda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/tianmoucv/proc/opticalflow/estimator.html#HS_optical_flow"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>多尺度HS方法计算稠密光流，效果更好
parameter:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param SD<span class="colon">:</span></dt>
<dd class="field-odd"><p>原始SD，SD[0,1]: x,y方向上的梯度,[2,h,w],torch.Tensor</p>
</dd>
<dt class="field-even">param TD<span class="colon">:</span></dt>
<dd class="field-even"><p>原始SD，TD[0]: t方向上的梯度,[1,h,w],torch.Tensor</p>
</dd>
<dt class="field-odd">param ifInterploted = False<span class="colon">:</span></dt>
<dd class="field-odd"><p>计算结果是否与COP等大</p>
</dd>
<dt class="field-even">param epsilon = 1e-8<span class="colon">:</span></dt>
<dd class="field-even"><p>收敛界</p>
</dd>
<dt class="field-odd">param maxIteration = 50<span class="colon">:</span></dt>
<dd class="field-odd"><p>最大迭代次数</p>
</dd>
<dt class="field-even">param scales = 4<span class="colon">:</span></dt>
<dd class="field-even"><p>尺度数量</p>
</dd>
<dt class="field-odd">param labmda=10<span class="colon">:</span></dt>
<dd class="field-odd"><p>惩罚因子,越大光流越平滑</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.opticalflow.spy_net.</span></span><span class="sig-name descname"><span class="pre">TianmoucOF_SpyNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_optim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/opticalflow/spy_net.html#TianmoucOF_SpyNet"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>基类：<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>计算稠密光流的nn方法
默认权重存储于’of_0918_ver_best.ckpt’
或初始化时指定ckpt_path</p>
<p>parameter:</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgsize</strong> – (w,h),list</p></li>
<li><p><strong>ckpt_path</strong> – string, path to weight dictionary</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">forward_time_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tsdiff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/opticalflow/spy_net.html#TianmoucOF_SpyNet.forward_time_range"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>&#64;tsdiff</strong> – [c,n,w,h], -1~1,torch，decoder的输出直接concate的结果</p></li>
<li><p><strong>&#64;t1</strong> – </p></li>
<li><p><strong>[</strong><strong>0</strong> (<em>t2 in</em>) – </p></li>
<li><p><strong>t1-t2</strong> (<em>n</em><em>]  </em><em>calculate the OF between</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="reconstructor">
<span id="index-rec"></span><h3>重建算法库(reconstructor)<a class="headerlink" href="#reconstructor" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.reconstruct.basic.</span></span><span class="sig-name descname"><span class="pre">laplacian_blending_1c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Iy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/reconstruct/basic.html#laplacian_blending_1c"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p># 灰度重建-不直接调用
# vectorized by Y. Lin
# Function to apply lap blending to two images</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.reconstruct.basic.</span></span><span class="sig-name descname"><span class="pre">laplacian_blending_1c_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Iy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/reconstruct/basic.html#laplacian_blending_1c_batch"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p># 灰度重建-支持batch的网络训练用接口
# vectorized by Y. Lin
# Function to apply Poisson blending to two images</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.reconstruct.basic.</span></span><span class="sig-name descname"><span class="pre">genMask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">255</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/reconstruct/basic.html#genMask"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>生成过欠曝区域遮罩</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.reconstruct.basic.</span></span><span class="sig-name descname"><span class="pre">laplacian_blending</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Iy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srcimg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_rgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/reconstruct/basic.html#laplacian_blending"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>RGB/灰度 HDR 融合重建</p>
<p>vectorized by Y. Lin
Function to apply Poisson blending to two images
:Ix,Iy: [h,w]，x和y方向的梯度
:sciimg: [None],[h,w],[h,w,3]，分别进入不同模式</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.reconstruct.basic.</span></span><span class="sig-name descname"><span class="pre">batch_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">320</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">640</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda',</span> <span class="pre">index=0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifsingleDirection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speedUpRate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/reconstruct/basic.html#batch_inference"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>model need to implement “result = forward_batch(F_batch, td_batch,SD0_batch,SD1_batch)”</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.reconstruct.integration.</span></span><span class="sig-name descname"><span class="pre">TD_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tsdiff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TD_BG_NOISE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshGate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01568627450980392</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dig_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tianmoucv/proc/reconstruct/integration.html#TD_integration"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>AOP+COP合成灰度</p>
<ol class="arabic simple">
<li><p>校正TD的正向和负向差分的不一致性</p></li>
<li><p>计算AOP到COP的线性缩放系数</p></li>
<li><p>laplacian_blending</p></li>
<li><p>双向TD积累+SD灰度合成最终结果</p></li>
</ol>
<dl class="simple">
<dt>parameter:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param F0<span class="colon">:</span></dt>
<dd class="field-odd"><p>[h,w,3],torch.Tensor</p>
</dd>
<dt class="field-even">param F0<span class="colon">:</span></dt>
<dd class="field-even"><p>[h,w,3],torch.Tensor</p>
</dd>
<dt class="field-odd">param tsdiff<span class="colon">:</span></dt>
<dd class="field-odd"><p>[3,T,h,w],torch.Tensor, 默认decoded结果的堆积</p>
</dd>
<dt class="field-even">param TDnoise<span class="colon">:</span></dt>
<dd class="field-even"><p>噪声矩阵 [h,w], torch.Tensor</p>
</dd>
<dt class="field-odd">param threshGate=4/255<span class="colon">:</span></dt>
<dd class="field-odd"><p>积累时的噪声阈值</p>
</dd>
<dt class="field-even">param t<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tianmoucv.proc.reconstruct.integration.</span></span><span class="sig-name descname"><span class="pre">SD_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SDx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SDy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="../_modules/tianmoucv/proc/reconstruct/integration.html#SD_integration"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a></dt>
<dd><p>SD直接积分累加重建，简单可视化用
use mapped SDx and SDy to conduct direct integration</p>
</dd></dl>

</section>
</section>
<section id="index-examples">
<span id="id4"></span><h2>调用示例<a class="headerlink" href="#index-examples" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="feature_matching/feature_matching.html">Haris角点和SIFT特征描述符</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature_tracking_tested/feature_tracking_tested.html">基于SD的特征追踪</a></li>
<li class="toctree-l1"><a class="reference internal" href="opticalflow_HS_method/opticalflow_HS_method.html">基于HS方法的实时光流计算</a></li>
<li class="toctree-l1"><a class="reference internal" href="opticalflow_LK_method/opticalflow_LK_method.html">基于LK方法的实时光流计算</a></li>
<li class="toctree-l1"><a class="reference internal" href="opticalflow_SPYNET/opticalflow_SPYNET.html">基于SpyNet的光流网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconstruct_gray/reconstruct_gray.html">基于AOP的灰度重建</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconstruct_hdr_Laplacian/reconstruct_hdr_Laplacian.html">HDR单帧合成</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconstruct_tiny_unet/reconstruct_tiny_unet.html">轻量化视频重建</a></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="../index.html" class="btn btn-neutral float-left" title="欢迎来到天眸视觉(TianMouCV)的项目主页" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="feature_matching/feature_matching.html" class="btn btn-neutral float-right" title="Haris角点和SIFT特征描述符" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2024, THU-CBICR。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>